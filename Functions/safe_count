library(readxl)
library(dplyr)
library(rlang)

safe_count <- function(df, field, name) {
  if (nrow(df) == 0 || !field %in% names(df)) {
    tibble::tibble(INSTCODE = character(0), !!name := integer(0))
  } else {
    df %>% count(!!sym(field), name = name) %>% rename(INSTCODE = !!field)
  }
}
